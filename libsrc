-- PurpleUI Library v1.0 - Complete Version
-- Make sure to copy this ENTIRE file to GitHub

local PurpleUI = {}
PurpleUI.__index = PurpleUI
PurpleUI._Version = "1.0.0"

local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local Players = game:GetService("Players")
local CoreGui = game:GetService("CoreGui")

local THEME = {
    Primary = Color3.fromRGB(147, 51, 234),
    PrimaryLight = Color3.fromRGB(167, 91, 255),
    PrimaryDark = Color3.fromRGB(107, 33, 168),
    Background = Color3.fromRGB(20, 20, 30),
    BackgroundLight = Color3.fromRGB(30, 30, 45),
    ElementBackground = Color3.fromRGB(35, 35, 50),
    ElementHover = Color3.fromRGB(45, 45, 65),
    ElementActive = Color3.fromRGB(55, 55, 75),
    Text = Color3.fromRGB(255, 255, 255),
    TextDim = Color3.fromRGB(180, 180, 200),
    Border = Color3.fromRGB(60, 60, 80),
    BorderActive = Color3.fromRGB(147, 51, 234),
    Error = Color3.fromRGB(239, 68, 68),
}

local ANIM_SPEED = 0.15
local CORNER_RADIUS = UDim.new(0, 6)
local PADDING = 8
local SPACING = 6
local TITLE_HEIGHT = 32
local ELEMENT_HEIGHT = 28

local function Tween(obj, props, duration)
    TweenService:Create(obj, TweenInfo.new(duration or ANIM_SPEED, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), props):Play()
end

local function Corner(parent, radius)
    local c = Instance.new("UICorner")
    c.CornerRadius = radius or CORNER_RADIUS
    c.Parent = parent
    return c
end

local function Padding(parent, size)
    local p = Instance.new("UIPadding")
    p.PaddingLeft = UDim.new(0, size or PADDING)
    p.PaddingRight = UDim.new(0, size or PADDING)
    p.PaddingTop = UDim.new(0, size or PADDING)
    p.PaddingBottom = UDim.new(0, size or PADDING)
    p.Parent = parent
    return p
end

local function Stroke(parent, color, thickness)
    local s = Instance.new("UIStroke")
    s.Color = color or THEME.Border
    s.Thickness = thickness or 1
    s.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
    s.Parent = parent
    return s
end

local function Gradient(parent, c1, c2, rotation)
    local g = Instance.new("UIGradient")
    g.Color = ColorSequence.new(c1, c2)
    g.Rotation = rotation or 90
    g.Parent = parent
    return g
end

local function MakeDraggable(frame, handle)
    local dragging, dragInput, dragStart, startPos
    handle = handle or frame
    
    handle.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            dragStart = input.Position
            startPos = frame.Position
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                end
            end)
        end
    end)
    
    handle.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            dragInput = input
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            local delta = input.Position - dragStart
            Tween(frame, {Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)}, 0.05)
        end
    end)
end

local Window = {}
Window.__index = Window

function Window.new(title, size)
    local self = setmetatable({}, Window)
    self.Title = title or "PurpleUI"
    self.Size = size or UDim2.new(0, 500, 0, 600)
    self.Flags = {}
    
    self.ScreenGui = Instance.new("ScreenGui")
    self.ScreenGui.Name = "PurpleUI_" .. self.Title
    self.ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    self.ScreenGui.ResetOnSpawn = false
    
    pcall(function() self.ScreenGui.Parent = CoreGui end)
    if not self.ScreenGui.Parent then
        self.ScreenGui.Parent = Players.LocalPlayer:WaitForChild("PlayerGui")
    end
    
    self.Main = Instance.new("Frame")
    self.Main.Size = self.Size
    self.Main.Position = UDim2.new(0.5, -self.Size.X.Offset/2, 0.5, -self.Size.Y.Offset/2)
    self.Main.BackgroundColor3 = THEME.Background
    self.Main.BorderSizePixel = 0
    self.Main.ClipsDescendants = true
    self.Main.Parent = self.ScreenGui
    Corner(self.Main, UDim.new(0, 8))
    Stroke(self.Main, THEME.BorderActive, 2)
    
    self.TitleBar = Instance.new("Frame")
    self.TitleBar.Size = UDim2.new(1, 0, 0, TITLE_HEIGHT)
    self.TitleBar.BackgroundColor3 = THEME.BackgroundLight
    self.TitleBar.BorderSizePixel = 0
    self.TitleBar.Parent = self.Main
    Corner(self.TitleBar, UDim.new(0, 8))
    Gradient(self.TitleBar, THEME.Primary, THEME.PrimaryDark, 45)
    
    local titleFix = Instance.new("Frame")
    titleFix.Size = UDim2.new(1, 0, 0, 8)
    titleFix.Position = UDim2.new(0, 0, 1, -8)
    titleFix.BackgroundColor3 = THEME.Background
    titleFix.BorderSizePixel = 0
    titleFix.Parent = self.TitleBar
    
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Size = UDim2.new(1, -80, 1, 0)
    titleLabel.Position = UDim2.new(0, 12, 0, 0)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Text = self.Title
    titleLabel.TextColor3 = THEME.Text
    titleLabel.TextSize = 16
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.Parent = self.TitleBar
    
    local closeBtn = Instance.new("TextButton")
    closeBtn.Size = UDim2.new(0, 28, 0, 28)
    closeBtn.Position = UDim2.new(1, -32, 0, 2)
    closeBtn.BackgroundColor3 = THEME.Error
    closeBtn.Text = "Ã—"
    closeBtn.TextColor3 = THEME.Text
    closeBtn.TextSize = 20
    closeBtn.Font = Enum.Font.GothamBold
    closeBtn.BorderSizePixel = 0
    closeBtn.Parent = self.TitleBar
    Corner(closeBtn, UDim.new(0, 6))
    
    closeBtn.MouseButton1Click:Connect(function()
        Tween(self.Main, {Size = UDim2.new(0, 0, 0, 0)}, 0.2)
        wait(0.2)
        self.ScreenGui:Destroy()
    end)
    
    closeBtn.MouseEnter:Connect(function() Tween(closeBtn, {BackgroundColor3 = Color3.fromRGB(255, 88, 88)}) end)
    closeBtn.MouseLeave:Connect(function() Tween(closeBtn, {BackgroundColor3 = THEME.Error}) end)
    
    self.Container = Instance.new("ScrollingFrame")
    self.Container.Size = UDim2.new(1, 0, 1, -TITLE_HEIGHT - PADDING)
    self.Container.Position = UDim2.new(0, 0, 0, TITLE_HEIGHT + PADDING)
    self.Container.BackgroundTransparency = 1
    self.Container.BorderSizePixel = 0
    self.Container.ScrollBarThickness = 8
    self.Container.ScrollBarImageColor3 = THEME.Primary
    self.Container.CanvasSize = UDim2.new(0, 0, 0, 0)
    self.Container.Parent = self.Main
    Padding(self.Container, PADDING)
    
    self.Layout = Instance.new("UIListLayout")
    self.Layout.SortOrder = Enum.SortOrder.LayoutOrder
    self.Layout.Padding = UDim.new(0, SPACING)
    self.Layout.Parent = self.Container
    
    self.Layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        self.Container.CanvasSize = UDim2.new(0, 0, 0, self.Layout.AbsoluteContentSize.Y + PADDING * 2)
    end)
    
    MakeDraggable(self.Main, self.TitleBar)
    
    self.Main.Size = UDim2.new(0, 0, 0, 0)
    Tween(self.Main, {Size = self.Size}, 0.3)
    
    return self
end

function Window:AddButton(text, callback)
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(1, 0, 0, ELEMENT_HEIGHT)
    btn.BackgroundColor3 = THEME.ElementBackground
    btn.Text = text
    btn.TextColor3 = THEME.Text
    btn.TextSize = 14
    btn.Font = Enum.Font.Gotham
    btn.BorderSizePixel = 0
    btn.AutoButtonColor = false
    btn.Parent = self.Container
    Corner(btn)
    
    local grad = Gradient(btn, THEME.Primary, THEME.PrimaryDark, 90)
    grad.Enabled = false
    
    btn.MouseEnter:Connect(function()
        grad.Enabled = true
        Tween(btn, {BackgroundColor3 = THEME.ElementHover})
    end)
    
    btn.MouseLeave:Connect(function()
        grad.Enabled = false
        Tween(btn, {BackgroundColor3 = THEME.ElementBackground})
    end)
    
    btn.MouseButton1Click:Connect(function()
        if callback then callback() end
    end)
    
    return self
end

function Window:AddToggle(text, default, callback)
    local flagName = text:gsub("%s+", "_")
    self.Flags[flagName] = default or false
    
    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(1, 0, 0, ELEMENT_HEIGHT)
    frame.BackgroundColor3 = THEME.ElementBackground
    frame.BorderSizePixel = 0
    frame.Parent = self.Container
    Corner(frame)
    
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, -50, 1, 0)
    label.Position = UDim2.new(0, 10, 0, 0)
    label.BackgroundTransparency = 1
    label.Text = text
    label.TextColor3 = THEME.Text
    label.TextSize = 14
    label.Font = Enum.Font.Gotham
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.Parent = frame
    
    local switch = Instance.new("Frame")
    switch.Size = UDim2.new(0, 40, 0, 20)
    switch.Position = UDim2.new(1, -45, 0.5, -10)
    switch.BackgroundColor3 = THEME.ElementActive
    switch.BorderSizePixel = 0
    switch.Parent = frame
    Corner(switch, UDim.new(0, 10))
    
    local knob = Instance.new("Frame")
    knob.Size = UDim2.new(0, 16, 0, 16)
    knob.Position = UDim2.new(0, 2, 0.5, -8)
    knob.BackgroundColor3 = THEME.Text
    knob.BorderSizePixel = 0
    knob.Parent = switch
    Corner(knob, UDim.new(0, 8))
    
    local function Update(state)
        self.Flags[flagName] = state
        if state then
            Tween(switch, {BackgroundColor3 = THEME.Primary})
            Tween(knob, {Position = UDim2.new(1, -18, 0.5, -8)})
        else
            Tween(switch, {BackgroundColor3 = THEME.ElementActive})
            Tween(knob, {Position = UDim2.new(0, 2, 0.5, -8)})
        end
        if callback then callback(state) end
    end
    
    local btn = Instance.new("TextButton")
    btn.Size = UDim2.new(1, 0, 1, 0)
    btn.BackgroundTransparency = 1
    btn.Text = ""
    btn.Parent = frame
    
    btn.MouseButton1Click:Connect(function()
        Update(not self.Flags[flagName])
    end)
    
    btn.MouseEnter:Connect(function() Tween(frame, {BackgroundColor3 = THEME.ElementHover}) end)
    btn.MouseLeave:Connect(function() Tween(frame, {BackgroundColor3 = THEME.ElementBackground}) end)
    
    Update(self.Flags[flagName])
    return self
end

function Window:AddSlider(text, min, max, default, callback)
    local flagName = text:gsub("%s+", "_")
    self.Flags[flagName] = default or min
    
    local frame = Instance.new("Frame")
    frame.Size = UDim2.new(1, 0, 0, ELEMENT_HEIGHT + 20)
    frame.BackgroundColor3 = THEME.ElementBackground
    frame.BorderSizePixel = 0
    frame.Parent = self.Container
    Corner(frame)
    
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, -60, 0, 20)
    label.Position = UDim2.new(0, 10, 0, 4)
    label.BackgroundTransparency = 1
    label.Text = text
    label.TextColor3 = THEME.Text
    label.TextSize = 14
    label.Font = Enum.Font.Gotham
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.Parent = frame
    
    local valLabel = Instance.new("TextLabel")
    valLabel.Size = UDim2.new(0, 50, 0, 20)
    valLabel.Position = UDim2.new(1, -55, 0, 4)
    valLabel.BackgroundTransparency = 1
    valLabel.Text = tostring(default or min)
    valLabel.TextColor3 = THEME.Primary
    valLabel.TextSize = 14
    valLabel.Font = Enum.Font.GothamBold
    valLabel.TextXAlignment = Enum.TextXAlignment.Right
    valLabel.Parent = frame
    
    local track = Instance.new("Frame")
    track.Size = UDim2.new(1, -20, 0, 4)
    track.Position = UDim2.new(0, 10, 1, -14)
    track.BackgroundColor3 = THEME.ElementActive
    track.BorderSizePixel = 0
    track.Parent = frame
    Corner(track, UDim.new(0, 2))
    
    local fill = Instance.new("Frame")
    fill.Size = UDim2.new(0, 0, 1, 0)
    fill.BackgroundColor3 = THEME.Primary
    fill.BorderSizePixel = 0
    fill.Parent = track
    Corner(fill, UDim.new(0, 2))
    Gradient(fill, THEME.Primary, THEME.PrimaryLight, 90)
    
    local dragging = false
    
    local function Update(value)
        value = math.clamp(value, min, max)
        self.Flags[flagName] = value
        local percent = (value - min) / (max - min)
        Tween(fill, {Size = UDim2.new(percent, 0, 1, 0)}, 0.1)
        valLabel.Text = string.format("%.1f", value)
        if callback then callback(value) end
    end
    
    track.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            local function Calc()
                local mouse = UserInputService:GetMouseLocation().X
                local pos = track.AbsolutePosition.X
                local size = track.AbsoluteSize.X
                local percent = math.clamp((mouse - pos) / size, 0, 1)
                Update(min + (max - min) * percent)
            end
            Calc()
            local conn
            conn = UserInputService.InputEnded:Connect(function(endInput)
                if endInput.UserInputType == Enum.UserInputType.MouseButton1 then
                    dragging = false
                    conn:Disconnect()
                end
            end)
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            local mouse = input.Position.X
            local pos = track.AbsolutePosition.X
            local size = track.AbsoluteSize.X
            local percent = math.clamp((mouse - pos) / size, 0, 1)
            Update(min + (max - min) * percent)
        end
    end)
    
    Update(self.Flags[flagName])
    return self
end

function Window:AddLabel(text)
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, 0, 0, 24)
    label.BackgroundColor3 = THEME.BackgroundLight
    label.Text = text
    label.TextColor3 = THEME.Text
    label.TextSize = 14
    label.Font = Enum.Font.Gotham
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.BorderSizePixel = 0
    label.Parent = self.Container
    Corner(label)
    Padding(label, 8)
    return self
end

function Window:AddDivider()
    local div = Instance.new("Frame")
    div.Size = UDim2.new(1, 0, 0, 1)
    div.BackgroundColor3 = THEME.Border
    div.BorderSizePixel = 0
    div.Parent = self.Container
    return self
end

function Window:AddSection(text)
    local section = Instance.new("Frame")
    section.Size = UDim2.new(1, 0, 0, 32)
    section.BackgroundTransparency = 1
    section.Parent = self.Container
    
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, 0, 1, 0)
    label.BackgroundTransparency = 1
    label.Text = text
    label.TextColor3 = THEME.Primary
    label.TextSize = 16
    label.Font = Enum.Font.GothamBold
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.Parent = section
    
    local line = Instance.new("Frame")
    line.Size = UDim2.new(1, 0, 0, 2)
    line.Position = UDim2.new(0, 0, 1, -4)
    line.BackgroundColor3 = THEME.Primary
    line.BorderSizePixel = 0
    line.Parent = section
    Corner(line, UDim.new(0, 1))
    Gradient(line, THEME.Primary, Color3.fromRGB(0, 0, 0), 90)
    
    return self
end

function Window:Notify(title, message, duration)
    duration = duration or 3
    local notif = Instance.new("Frame")
    notif.Size = UDim2.new(0, 300, 0, 80)
    notif.Position = UDim2.new(1, -320, 1, 100)
    notif.BackgroundColor3 = THEME.BackgroundLight
    notif.BorderSizePixel = 0
    notif.Parent = self.ScreenGui
    Corner(notif, UDim.new(0, 8))
    Stroke(notif, THEME.Primary, 2)
    Padding(notif, 12)
    
    local titleLabel = Instance.new("TextLabel")
    titleLabel.Size = UDim2.new(1, 0, 0, 20)
    titleLabel.BackgroundTransparency = 1
    titleLabel.Text = title
    titleLabel.TextColor3 = THEME.Text
    titleLabel.TextSize = 14
    titleLabel.Font = Enum.Font.GothamBold
    titleLabel.TextXAlignment = Enum.TextXAlignment.Left
    titleLabel.Parent = notif
    
    local msgLabel = Instance.new("TextLabel")
    msgLabel.Size = UDim2.new(1, 0, 1, -24)
    msgLabel.Position = UDim2.new(0, 0, 0, 24)
    msgLabel.BackgroundTransparency = 1
    msgLabel.Text = message
    msgLabel.TextColor3 = THEME.TextDim
    msgLabel.TextSize = 12
    msgLabel.Font = Enum.Font.Gotham
    msgLabel.TextXAlignment = Enum.TextXAlignment.Left
    msgLabel.TextYAlignment = Enum.TextYAlignment.Top
    msgLabel.TextWrapped = true
    msgLabel.Parent = notif
    
    Tween(notif, {Position = UDim2.new(1, -320, 1, -100)}, 0.3)
    task.wait(duration)
    Tween(notif, {Position = UDim2.new(1, -320, 1, 100)}, 0.3)
    task.wait(0.3)
    notif:Destroy()
end

function PurpleUI:CreateWindow(title, size)
    return Window.new(title, size)
end

return PurpleUI
